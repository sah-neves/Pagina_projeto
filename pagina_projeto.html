<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <title>TeamBuilder — Detalhes do Projeto</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="pagina_projeto.css">
</head>
<body>
  <header class="topbar">
    <div class="brand">TeamBuilder</div>
    <nav class="menu">
      <a href="home.html" class="link">Home</a>
      <a href="criar_projeto.html" class="link">+ Novo Projeto</a>
    </nav>
  </header>

  <main class="container">
    <!-- Cabeçalho do Projeto -->
    <div class="project-header">
      <div class="project-info">
        <h1 class="project-title" id="projectTitle">Plataforma de E-commerce</h1>
        <p class="project-subtitle">Desenvolvimento de uma plataforma completa de vendas online</p>
        <div class="project-meta">
          <div class="meta-item">
            <i class="fas fa-calendar"></i>
            <span>Criado em 15/01/2024</span>
          </div>
          <div class="meta-item">
            <i class="fas fa-users"></i>
            <span>5 membros na equipe</span>
          </div>
        </div>
      </div>
      <div class="project-status-container">
        <span class="project-status status-active">Em Andamento</span>
      </div>
    </div>

    <!-- Grid de Conteúdo Principal -->
    <div class="main-content-grid">
      <!-- Coluna Principal - Informações do Projeto -->
      <div class="main-column">
        <!-- Descrição do Projeto -->
        <section class="content-card project-description-card">
          <h3><i class="fas fa-info-circle"></i> Sobre o Projeto</h3>
          <div class="project-description" id="projectDescription">
            Desenvolvimento de uma plataforma completa de vendas online com sistema de pagamentos integrado, 
            gestão de estoque, painel administrativo e aplicativo mobile. O projeto visa criar uma solução 
            escalável que atenda tanto pequenos empreendedores quanto grandes empresas.
          </div>
        </section>

        <!-- Membros Selecionados -->
        <section class="content-card selected-members-card">
          <h3><i class="fas fa-user-check"></i> Membros Selecionados</h3>
          <p class="section-description">Colaboradores escolhidos para participar do projeto</p>
          <div id="selectedMembersList" class="selected-members-list">
            <div class="empty-state">
              <i class="fas fa-user-plus"></i>
              <p>Nenhum colaborador selecionado ainda</p>
              <small>Use o assistente IA para recomendar colaboradores ideais</small>
            </div>
          </div>
        </section>

        <!-- Habilidades Necessárias -->
        <section class="content-card">
          <h3><i class="fas fa-code"></i> Habilidades Necessárias</h3>
          <p class="section-description">Tecnologias e competências requeridas para o projeto</p>
          <div class="skills-list" id="skillsList">
            <span class="skill-tag">React</span>
            <span class="skill-tag">Node.js</span>
            <span class="skill-tag">PostgreSQL</span>
            <span class="skill-tag">Stripe API</span>
            <span class="skill-tag">TypeScript</span>
            <span class="skill-tag">Docker</span>
          </div>
        </section>
      </div>

      <!-- Coluna Lateral - Equipe e Ferramentas -->
      <div class="sidebar-column">
        <!-- Colaboradores -->
        <section class="content-card">
          <h3><i class="fas fa-users"></i>Colaboradores</h3>
          <p class="section-description">Escolher Colaboradores para o Projeto</p>
          
          <!-- Assistente IA para Recomendação -->
          <div class="ai-recommendation-section">
            <div class="ai-content">
              <div class="ai-text">
                <h4>Assistente IA</h4>
                <p>Recomende colaboradores ideais baseado nas habilidades do projeto</p>
              </div>
            </div>
            <button class="ai-button" id="aiAssistantBtn">
              <i class="fas fa-magic"></i> Recomendar Colaboradores
            </button>
          </div>

          <!-- Lista de Colaboradores Recomendados -->
          <div id="collaboratorsList" class="collaborators-list">
            <!-- Lista será preenchida via JavaScript -->
          </div>
        </section>
        
      </div>
    </div>
  </main>

  <script>
    // Dados mock do projeto (em produção, viria da API)
    const mockProject = {
      id: '1',
      title: 'Plataforma de E-commerce',
      description: 'Desenvolvimento de uma plataforma completa de vendas online com sistema de pagamentos integrado, gestão de estoque, painel administrativo e aplicativo mobile. O projeto visa criar uma solução escalável que atenda tanto pequenos empreendedores quanto grandes empresas.',
      status: 'active',
      createdAt: '2024-01-15',
      skills: ['React', 'Node.js', 'PostgreSQL', 'Stripe API', 'TypeScript', 'Docker'],
      teamSize: 5,
      collaborators: [
        { id: '1', name: 'Sarah Chen', role: 'Full Stack Developer', status: 'online' },
        { id: '2', name: 'Marcus Johnson', role: 'DevOps Engineer', status: 'busy' },
        { id: '3', name: 'Ana Silva', role: 'UI/UX Designer', status: 'online' },
        { id: '4', name: 'Carlos Mendes', role: 'Backend Developer', status: 'offline' },
        { id: '5', name: 'Marina Costa', role: 'Product Manager', status: 'online' }
      ]
    };

    // Referências DOM
    const projectTitle = document.getElementById('projectTitle');
    const projectDescription = document.getElementById('projectDescription');
    const skillsList = document.getElementById('skillsList');
    const collaboratorsList = document.getElementById('collaboratorsList');
    const selectedMembersList = document.getElementById('selectedMembersList');
    const aiAssistantBtn = document.getElementById('aiAssistantBtn');

    // Estado dos colaboradores
    let selectedMembers = [];
    let availableCollaborators = [];

    // Funções utilitárias
    function formatDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('pt-BR');
    }

    function getStatusInfo(status) {
      const statusMap = {
        'active': { class: 'status-active', text: 'Em Andamento' },
        'pending': { class: 'status-pending', text: 'Pendente' },
        'completed': { class: 'status-completed', text: 'Concluído' },
        'cancelled': { class: 'status-cancelled', text: 'Cancelado' }
      };
      return statusMap[status] || { class: 'status-pending', text: 'Pendente' };
    }

    function getInitials(name) {
      return name.split(' ').map(n => n[0]).join('').toUpperCase();
    }

    function renderCollaborators(collaborators) {
      collaboratorsList.innerHTML = '';
      availableCollaborators = collaborators;
      
      collaborators.forEach(collaborator => {
        const collaboratorElement = document.createElement('div');
        collaboratorElement.className = 'collaborator-item';
        const isSelected = selectedMembers.some(m => m.id === collaborator.id);
        
        collaboratorElement.innerHTML = `
          <div class="collaborator-avatar">${getInitials(collaborator.name)}</div>
          <div class="collaborator-info">
            <div class="collaborator-name">${collaborator.name}</div>
            <div class="collaborator-role">${collaborator.role}</div>
          </div>
          <div class="collaborator-actions">
            <div class="collaborator-status ${collaborator.status}"></div>
            <button class="btn btn-sm ${isSelected ? 'btn-primary' : 'btn-outline'}" 
                    onclick="toggleCollaborator('${collaborator.id}')">
              <i class="fas ${isSelected ? 'fa-check' : 'fa-plus'}"></i>
              ${isSelected ? 'Selecionado' : 'Selecionar'}
            </button>
          </div>
        `;
        
        collaboratorsList.appendChild(collaboratorElement);
      });
    }

    function toggleCollaborator(collaboratorId) {
      const collaborator = availableCollaborators.find(c => c.id === collaboratorId);
      const isSelected = selectedMembers.some(m => m.id === collaboratorId);
      
      if (isSelected) {
        selectedMembers = selectedMembers.filter(m => m.id !== collaboratorId);
      } else {
        selectedMembers.push(collaborator);
      }
      
      renderCollaborators(availableCollaborators);
      renderSelectedMembers();
    }

    function renderSelectedMembers() {
      if (selectedMembers.length === 0) {
        selectedMembersList.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-user-plus"></i>
            <p>Nenhum colaborador selecionado ainda</p>
            <small>Use o assistente IA para recomendar colaboradores ideais</small>
          </div>
        `;
        return;
      }
      
      selectedMembersList.innerHTML = selectedMembers.map(member => `
        <div class="collaborator-item selected">
          <div class="collaborator-avatar">${getInitials(member.name)}</div>
          <div class="collaborator-info">
            <div class="collaborator-name">${member.name}</div>
            <div class="collaborator-role">${member.role}</div>
          </div>
          <div class="collaborator-actions">
            <div class="collaborator-status ${member.status}"></div>
            <button class="btn btn-sm btn-danger" onclick="removeSelectedMember('${member.id}')">
              <i class="fas fa-times"></i>
              Remover
            </button>
          </div>
        </div>
      `).join('');
    }

    function removeSelectedMember(collaboratorId) {
      selectedMembers = selectedMembers.filter(m => m.id !== collaboratorId);
      renderCollaborators(availableCollaborators);
      renderSelectedMembers();
    }

    function renderProject(project) {
      // Atualiza título e descrição
      projectTitle.textContent = project.title;
      projectDescription.textContent = project.description;

      // Renderiza habilidades
      skillsList.innerHTML = project.skills.map(skill => 
        `<span class="skill-tag">${skill}</span>`
      ).join('');

      // Atualiza status
      const statusElement = document.querySelector('.project-status');
      const statusInfo = getStatusInfo(project.status);
      statusElement.className = `project-status ${statusInfo.class}`;
      statusElement.textContent = statusInfo.text;

      // Renderiza colaboradores
      if (project.collaborators) {
        renderCollaborators(project.collaborators);
        renderSelectedMembers();
      }
    }

    // Função do Assistente IA (placeholder para futura integração)
    function handleAIAssistant() {
      // Simula carregamento
      aiAssistantBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Analisando...';
      aiAssistantBtn.disabled = true;

      setTimeout(() => {
        // Simula resposta da IA
        alert('🤖 Assistente IA:\n\n' +
              'Recomendações para seu projeto:\n\n' +
              '• Considere adicionar testes automatizados\n' +
              '• Implemente monitoramento de performance\n' +
              '• Adicione documentação técnica\n' +
              '• Configure CI/CD pipeline\n\n' +
              'Essa funcionalidade será integrada com IA real em breve!');
        
        aiAssistantBtn.innerHTML = '<i class="fas fa-magic"></i> Obter Recomendações';
        aiAssistantBtn.disabled = false;
      }, 2000);
    }
    
    async function loadProject() {
      try {
        // Simula carregamento da API
        await new Promise(resolve => setTimeout(resolve, 500));
        
        // Em produção, substitua por:
        // const projectId = new URLSearchParams(window.location.search).get('id');
        // const response = await fetch(`/api/projects/${projectId}`);
        // const project = await response.json();
        
        renderProject(mockProject);
      } catch (error) {
        console.error('Erro ao carregar projeto:', error);
        alert('Erro ao carregar os dados do projeto. Tente novamente.');
      }
    }

    aiAssistantBtn.addEventListener('click', handleAIAssistant);

    // Inicialização
    loadProject();
  </script>
</body>
</html>